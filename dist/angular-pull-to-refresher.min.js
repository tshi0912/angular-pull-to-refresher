/**
 * angular-pull-to-refresher
 * @version v0.1.0 - 2015-08-19
 * @link https://github.com/tshi0912/angular-pull-to-refresher
 * @author Jim Shi <tshi0912@gmail.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(a,b,c){"use strict";var d=function(){var a={contentEl:"content",ptrEl:"ptr",distanceToRefresh:70,loadingFunction:!1,resistance:2.5},c={},d={enabled:!1,distance:0,startingPositionY:0},e=b.body.classList,f=function(d){if(d=d||{},c={contentEl:d.contentEl||b.getElementById(a.contentEl),ptrEl:d.ptrEl||b.getElementById(a.ptrEl),distanceToRefresh:d.distanceToRefresh||a.distanceToRefresh,loadingFunction:d.loadingFunction||a.loadingFunction,resistance:d.resistance||a.resistance},!c.contentEl||!c.ptrEl)return!1;var e=new Hammer(c.contentEl);e.get("pan").set({direction:Hammer.DIRECTION_VERTICAL}),e.on("panstart",g),e.on("pandown",h),e.on("panup",i),e.on("panend",l)},g=function(a){d.startingPositionY=b.body.scrollTop,0===d.startingPositionY&&(d.enabled=!0)},h=function(a){d.enabled&&(a.preventDefault(),d.distance=a.distance/c.resistance,j(),k())},i=function(a){d.enabled&&0!==d.distance&&(a.preventDefault(),d.distance<a.distance/c.resistance?d.distance=0:d.distance=a.distance/c.resistance,j(),k())},j=function(){c.contentEl.style.transform=c.contentEl.style.webkitTransform="translate3d( 0, "+d.distance+"px, 0 )",c.ptrEl.style.transform=c.ptrEl.style.webkitTransform="translate3d( 0, "+(d.distance-c.ptrEl.offsetHeight)+"px, 0 )"},k=function(){d.distance>c.distanceToRefresh?e.add("ptr-refresh"):e.remove("ptr-refresh")},l=function(a){d.enabled&&(a.preventDefault(),c.contentEl.style.transform=c.contentEl.style.webkitTransform="",c.ptrEl.style.transform=c.ptrEl.style.webkitTransform="",b.body.classList.contains("ptr-refresh")?m():n(),d.distance=0,d.enabled=!1)},m=function(){if(e.add("ptr-loading"),!c.loadingFunction)return n();var a=c.loadingFunction();setTimeout(function(){a.then(n)},1e3)},n=function(){e.remove("ptr-loading"),e.remove("ptr-refresh"),e.add("ptr-reset");var a=function(){e.remove("ptr-reset"),b.body.removeEventListener("transitionend",a,!1)};b.body.addEventListener("transitionend",a,!1)};return{init:f}}();angular.module("sfe.pullToRefresher",[]).constant("cfg",{distanceToRefresh:70,resistance:2.5}).directive("pullToRefresh",["$compile","$timeout","$q","cfg",function(a,b,c,e){return{scope:!0,restrict:"A",templateUrl:"angular-pull-to-refresher.tpl.html",compile:function(a,b,c){return function(a,b,c){var f=angular.extend({},e,c);d.init({contentEl:b.parent(),ptrEl:b.children()[0],distanceToRefresh:f.distanceToRefresh,resistance:f.resistance,loadingFunction:function(){return a.$eval(c.pullToRefresh)}})}}}}]),angular.module("sfe.pullToRefresher").run(["$templateCache",function(a){a.put("angular-pull-to-refresher.tpl.html",'<div class="ptr">\n   <i class="fa fa-arrow-down"></i>\n   <div class="loading">\n       <span class="l1"></span>\n       <span class="l2"></span>\n       <span class="l3"></span>\n   </div>\n</div>\n')}])}(window,document);